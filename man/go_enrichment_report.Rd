% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/go_enrichment_report.R
\name{go_enrichment_report}
\alias{go_enrichment_report}
\title{GO enrichment with compact plots — single set or per‑layer multinet}
\usage{
go_enrichment_report(
  genes = NULL,
  net = NULL,
  OrgDb,
  id_from = c("SYMBOL", "ENSEMBL", "ALIAS", "ENTREZID"),
  ont = c("BP", "MF", "CC"),
  layer_order = NULL,
  genes_by_layer = NULL,
  min_genes = 3,
  universe = NULL,
  universe_mode = c("none", "union"),
  pAdjustMethod = c("BH", "bonferroni", "BY", "fdr"),
  pvalueCutoff = 0.05,
  qvalueCutoff = 0.2,
  simplify = TRUE,
  simplify_cutoff = 0.7,
  simplify_by = "p.adjust",
  simplify_measure = "Wang",
  showCategory = 10,
  cnet_showCategory = 8,
  cnet_left_margin_pt = 80,
  include_barplot = TRUE,
  include_barplot_multinet = FALSE,
  out_dir = getOption("mlnet.results_dir", "omicsDNA_results"),
  file_prefix = NULL,
  save_pdf = TRUE,
  save_csv = TRUE,
  one_pdf = TRUE,
  show_in_rstudio = TRUE,
  width = 8.27,
  height = 11.69,
  verbose = TRUE
)
}
\arguments{
\item{genes}{Character vector of genes (single‑set mode).}

\item{net}{Optional \code{multinet::ml.network} (per‑layer mode).}

\item{OrgDb}{Annotation package (e.g., \code{org.Hs.eg.db}).}

\item{id_from, ont}{See \code{clusterProfiler::bitr}, \code{enrichGO} (default id_from="SYMBOL", ont="BP").}

\item{layer_order}{Optional vector giving the order of layers (multinet mode).}

\item{genes_by_layer}{Optional \strong{named list} layer -> character vector of genes.
If provided, overrides the default (all vertex names per layer).}

\item{min_genes}{Minimum number of mapped genes to run enrichment. Default 3.}

\item{universe}{Optional background (Entrez IDs). If \code{universe_mode="union"},
the background is the union of all mapped genes across layers.}

\item{universe_mode}{One of c("none","union"). Default "none".}

\item{pAdjustMethod, pvalueCutoff, qvalueCutoff}{Enrichment thresholds.}

\item{simplify, simplify_cutoff, simplify_by, simplify_measure}{Redundancy reduction options.}

\item{showCategory}{Number of categories in dotplot; \code{cnet_showCategory} for cnet.}

\item{cnet_showCategory}{Integer, often fewer than dotplot for legibility (default 8).}

\item{cnet_left_margin_pt}{Left margin (pt) added to cnet plot to avoid label clipping (default 80).}

\item{include_barplot}{Logical; include a bar plot in single‑set mode. Default TRUE.}

\item{include_barplot_multinet}{Logical; include a bar plot per layer in multinet mode. Default FALSE.}

\item{out_dir, file_prefix}{Output directory and file basename.}

\item{save_pdf, save_csv}{Write PDFs and CSVs? Defaults TRUE.}

\item{one_pdf}{If TRUE (multinet), use one combined PDF; else one file per layer. Default TRUE.}

\item{show_in_rstudio}{Print plots to current device (RStudio Plots). Default TRUE.}

\item{width, height}{Figure size for PDFs (inches).}

\item{verbose}{Verbose messages. Default TRUE.}
}
\value{
\itemize{
\item Single‑set: list(ego, table, pdf_file, csv_file, mapping).
\item Multinet: list(by_layer = \if{html}{\out{<named list>}}, combined_pdf, layer_files).
}
}
\description{
Runs GO enrichment (\pkg{clusterProfiler}) and produces a dotplot and a cnet plot.
In \strong{single‑set mode}, supply a vector of genes. In \strong{multinet mode}, supply a
\code{multinet::ml.network}; the function uses each layer's vertex set (by default)
as the genes for that layer. Plots are shown in RStudio (once) and then saved to PDF
(one combined file or one file per layer) — \strong{no duplicate pages}.
}
\details{
\itemize{
\item IDs are harmonised to ENTREZ; multiple testing via \code{pAdjustMethod} (default "BH").
\item Cnet labels can be protected from clipping via \code{cnet_left_margin_pt}.
\item Layers with too few mapped genes or no significant terms are skipped (with messages).
}
}
\examples{
\dontrun{
## Single set
g <- c("RHCG","SPRR1A","SPRR2A","SPRR3","KRT13","KRT4","CRNN")
res <- go_enrichment_report(genes = g, OrgDb = org.Hs.eg.db, ont = "BP",
                            file_prefix = "g5l7_1_GO_BP", show_in_rstudio = TRUE)

## Multinet (per layer), using each layer's vertex set as the gene list
out <- go_enrichment_report(net = net, OrgDb = org.Hs.eg.db, ont = "BP",
                            layer_order = multinet::layers_ml(net),
                            universe_mode = "union",
                            cnet_left_margin_pt = 100,
                            include_barplot_multinet = FALSE,
                            one_pdf = TRUE, file_prefix = "GO_BP_byLayer")
out$combined_pdf
}
}
