% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/detectCom.R
\name{detectCom}
\alias{detectCom}
\title{Community detection for multilayer networks}
\usage{
detectCom(
  net,
  method = c("glouvain", "louvain", "infomap", "clique", "abacus"),
  supra_graph = FALSE,
  layers = NULL,
  glouvain_gamma = 1,
  glouvain_omega = 1,
  clique.k = 3,
  clique.m = 1,
  infomap_overlapping = FALSE,
  infomap_directed = FALSE,
  infomap_self_links = TRUE,
  gamma = NULL,
  omega = NULL,
  k = NULL,
  m = NULL,
  overlapping = NULL,
  directed = NULL,
  self.links = NULL,
  edgeWeight = c("count", "sum"),
  min.actors = 15,
  min.layers = 2,
  relabel_by_size = TRUE,
  seed = NULL,
  results_dir = getOption("mlnet.results_dir", "omicsDNA_results"),
  save_to_rds = FALSE,
  rds_file = NULL,
  write_csv = TRUE,
  csv_prefix = "communities",
  verbose = TRUE,
  ...
)
}
\arguments{
\item{net}{A multilayer network of class \code{multinet::ml.network}.}

\item{method}{Community detection method. One of \code{"glouvain"} (or \code{"louvain"} as an alias),
\code{"infomap"}, \code{"clique"}, \code{"abacus"}.}

\item{supra_graph}{Logical. If \code{FALSE} (default), communities are detected using \pkg{multinet}.
If \code{TRUE}, communities are detected on a layer-aggregated supra-graph using \pkg{igraph}.}

\item{layers}{Optional character vector of layer names to include when \code{supra_graph = TRUE}.
Ignored when \code{supra_graph = FALSE}.}

\item{gamma}{Numeric (>0). Resolution parameter for \code{multinet::glouvain_ml()} (multilayer mode).}

\item{omega}{Numeric (>=0). Inter-layer coupling for \code{multinet::glouvain_ml()} (multilayer mode).}

\item{k}{Integer (>=3). Clique size threshold for clique percolation (multilayer mode) and
minimum clique size in supra-graph mode.}

\item{m}{Integer (>=1). Clique percolation parameter (multilayer mode only).}

\item{overlapping, directed, self.links}{Passed to \code{multinet::infomap_ml()} (multilayer mode).}

\item{edgeWeight}{Aggregation rule for supra-graph edges: \code{"count"} or \code{"sum"}.}

\item{min.actors}{Integer (>=1). In supra-graph mode, communities with fewer than this many
unique actors are removed. In multilayer mode, this is passed to \code{multinet::abacus_ml()}.}

\item{min.layers}{Integer (>=1). In supra-graph mode, communities represented in fewer than
this many layers are removed. In multilayer mode, this is passed to \code{multinet::abacus_ml()}.}

\item{relabel_by_size}{Logical. In supra-graph mode, optionally relabel retained communities
to \code{C1, C2, ...} by decreasing size. In multilayer mode, this affects only the \emph{saved}
membership CSV (the returned \pkg{multinet} object is not modified).}

\item{seed}{Optional integer seed for reproducibility.}

\item{results_dir}{Output directory for optional files. Created if missing.}

\item{save_to_rds}{Logical. If \code{TRUE}, saves the returned object (multilayer mode) or the
membership table (supra-graph mode) as an \code{.rds}.}

\item{rds_file}{Optional filename for the RDS output. If \code{NULL}, a timestamped name is used.}

\item{write_csv}{Logical. If \code{TRUE} (default), writes \strong{two} CSV files under \code{results_dir}:
(i) a CSV representation of the returned object (\code{<base>.csv}) and (ii) the main community
membership table (\code{<base>_membership.csv}).}

\item{csv_prefix}{Character prefix used to build output filenames.}

\item{verbose}{Logical. If \code{TRUE}, prints progress messages and output paths.}

\item{...}{Additional arguments passed to the underlying \code{multinet::*_ml()} function in
multilayer mode. Also accepts legacy alias names for compatibility.}
}
\value{
\itemize{
\item If \code{supra_graph = FALSE}: returns the object returned by the selected \code{multinet::*_ml()} method.
\item If \code{supra_graph = TRUE}: returns a data frame with columns \code{actor}, \code{com}, \code{layer}, \code{method},
with attributes \code{community_sizes}, \code{layer_span}, and \code{files}.
}
}
\description{
\code{detectCom()} identifies communities (modules) in a multilayer network of class
\code{multinet::ml.network}. The function supports two analysis modes:
\itemize{
\item \strong{Multilayer community detection (default; \code{supra_graph = FALSE})}:
community detection is performed directly on the multilayer structure using
the corresponding \pkg{multinet} routine (e.g., generalized Louvain, Infomap,
clique percolation, ABACUS). In this mode the function returns the native
\pkg{multinet} community object.
\item \strong{Supra-graph community detection (\code{supra_graph = TRUE})}:
selected layers are first aggregated into a single undirected actor–actor graph
(a “supra-graph”). A standard \pkg{igraph} community algorithm is then applied,
and community memberships are mapped back to each layer where the actor appears.
}

In supra-graph mode, communities can be filtered by minimum size (\code{min.actors})
and minimum layer coverage (\code{min.layers}), and optionally relabelled by decreasing
community size (\code{relabel_by_size}).
}
\details{
\subsection{Input to the function}{

The primary input is a multilayer network object (\code{net}) where actors correspond
to node identifiers (e.g., gene symbols) and edges represent within-layer interactions.
In supra-graph mode, edges are read from \code{multinet::edges_ml(net)} and (when available)
restricted to intra-layer edges before aggregation.
}

\subsection{Edge aggregation in supra-graph mode}{

When \code{supra_graph = TRUE}, edge aggregation across layers is controlled by \code{edgeWeight}:
\itemize{
\item \code{"count"}: supra-edge weight equals the number of layers containing that edge;
\item \code{"sum"}: supra-edge weight equals the sum of edge weights across layers (when available).
}
}

\subsection{Output files written to disk}{

Output files are optional and are written under \code{results_dir} (created if missing).
\itemize{
\item \strong{CSV outputs (two files; controlled by \code{write_csv})}
When \code{write_csv = TRUE} (default), the function writes two CSV files:
\enumerate{
\item \strong{A CSV representation of the returned object:}
\preformatted{<results_dir>/<base>.csv}
where \code{<base>} is:
\preformatted{<csv_prefix>_<method>_<mode>[_<edgeWeight>]_<timestamp>}
In multilayer mode, this file is produced via \code{as.data.frame()} on the
\pkg{multinet} community object. If coercion fails, a small placeholder CSV is written.

\item \strong{The main membership table (CSV):}
\preformatted{<results_dir>/<base>_membership.csv}
containing (at minimum) \code{actor}, \code{layer}, \code{com}, and \code{method}.
In multilayer mode, memberships are extracted from the \pkg{multinet} result when possible;
otherwise an empty membership table is written.
}
\item \strong{RDS (optional)}
When \code{save_to_rds = TRUE}, the returned object is saved as an \code{.rds}. In multilayer
mode this is the raw \pkg{multinet} community object; in supra-graph mode this is the
membership data frame.
}
}
}
