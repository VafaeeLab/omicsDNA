% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/com_vs_samples.R
\name{com_vs_samples}
\alias{com_vs_samples}
\title{Relate community counts to sample sizes across layers (with a quick scatter):}
\usage{
com_vs_samples(communities, num_samples)
}
\arguments{
\item{communities}{A data frame with columns:
\itemize{
\item \code{layer}: layer identifier, and
\item one of \code{cid} \strong{or} \code{com}: community membership per \verb{(actor, layer)} row.
(If \code{com} is supplied, it is copied into \code{cid} internally.)
Extra columns are ignored.
}}

\item{num_samples}{A \strong{named numeric vector} whose names are layer identifiers
and values are sample counts (non‑negative, finite). The set of names must
match the set of layers in \code{communities}.}
}
\value{
A \strong{named integer vector} giving the number of unique communities
per layer. The object carries one attribute:
\itemize{
\item \code{"plot"} — the \code{ggplot} object (scatter with an OLS line).
}
}
\description{
For each layer, count the number of \strong{unique communities} observed in a
community assignment table and relate this count to the \strong{number of samples}
in that layer. The function returns a named integer vector of per‑layer
community counts and, for convenience, prints a scatter plot with a simple
OLS trend line (via \code{geom_smooth(method = "lm")}). The resulting \code{ggplot}
object is attached to the return value as an attribute (\code{"plot"}).
}
\details{
\strong{Inputs expected}
\itemize{
\item \code{communities} must contain a \code{layer} column and exactly one community
identifier column among \strong{\code{cid}} (e.g., ABACUS output) or \strong{\code{com}}
(e.g., \code{detectCom()} output). If \code{com} is present, it is internally
copied to \code{cid} before counting.
\item \code{num_samples} must be a \strong{named numeric vector} whose names are layer
identifiers and whose values are sample counts (non‑negative, finite).
}

\strong{Behaviour}
\enumerate{
\item Compute the number of \strong{distinct} community IDs per layer.
\item Strictly validate that the set of layer names in \code{communities} matches the
names of \code{num_samples} (the function errors if they differ).
\item Assemble a small data frame and draw a scatter plot of \emph{samples} (y‑axis)
versus \emph{community count} (x‑axis) with a least‑squares trend line.
The plot is printed to the active graphics device and also stored as
an attribute on the return value.
}

\strong{Note on statistics}
The plot includes an OLS line for orientation but \strong{does not} compute or
annotate model statistics (R², p‑value). If you wish to report these, extract
the underlying data from \code{attr(x, "plot")} and fit a model explicitly.
}
\examples{
\dontrun{
# Example using detectCom() output (has `com` and `layer`)
ns <- c(E1 = 46, E2 = 22, M1 = 16, M2 = 27, M3 = 23, M4 = 26, M5 = 18, M6 = 15)
counts <- com_vs_samples(comm, ns)   # prints the plot
attr(counts, "plot")                 # access the ggplot object

# Example using ABACUS-like output (has `cid` and `layer`)
# counts2 <- com_vs_samples(ABACUS_communities, ns)
}

}
\seealso{
\code{\link{detectCom}} for obtaining community assignments.
}
